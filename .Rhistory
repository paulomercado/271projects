x2
x2*C
t(x2)
t(x2)*C
x1%*%C
x%*%C
x
C
x
x%*%C
x%*%C%*%z
View(A)
View(A)
t(B)%*%B
print(t(B)%*%B)
print(x%*%C%*%z)
print(t(B)%*%B)
print(x%*%C%*%z)
view(a)
print(x%*%C%*%z)
t(B)%*%B
t(B)%*%B
x%*%C%*%z
t(B)%*%B
t(B)%*%B
A <- matrix(data = rbind(c(-5,-1,3),c(-1,1,2),c(3,2,7)), nrow=3)
B <- matrix(data = rbind(c(6,-2,3),c(7,1,0),c(2,-3,5)), nrow=3)
C <- matrix(data = rbind(c(2,-3),c(-1,4),c(3,1)), nrow=3)
x <- c(3,-1,2)
y <- c(3,2,4)
z <- c(2,5)
print(x%*%C%*%z)
t(B)%*%B
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
t(B)%*%B
print("xTCz", x%*%C%*%z)
x%*%C%*%z
x%*%C%*%z #xTCZ
x%*%C%*%z #xTCZ#
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
x%*%C%*%z #"x{supsc('T')}"
print("x{supsc('T')}")
x{supsc('T')}
supsc(T)
tr(A%*%B)
A%*%B
tr(B%*%A)
trace(B%*%A)
sum(diag(A%*%B))
A%*%B
trace(B%*%A)
trace(B%*%A)
A%*%B
sum(diag(A%*%B))
trace(B%*%A)
foo(B%*%A)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
inv(A%*%B)
inv(A)
inv(B)%*%inv(A)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
sessionInfo()
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
A%*%B
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
Solve(inv(B)%*%inv(A), fraction = True)
Solve(inv(B)%*%inv(A), fraction = TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
solve(A%*%B)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
MASS::fractions(solve(A%*%B))
fractions(inv(A%*%B))
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
MASS:fractions(inv(A%*%B))
MASS::fractions(inv(A%*%B))
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
MASS::fractions(inv(B)%*%inv(A))
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
inv(B)%*%inv(A)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
inv(A%*%B)
inv(B)%*%solve(A)
inv(B)%*%inv(A)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
sigma12
fractions(sigma12)
sigma22 <- (1/13)*matrix(cbind(c(1,2,1),c(3,-2,3)), nrow=2, byrow=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
sigma22
fractions(sigma22)
solve(sigma22)
fractions(solve(sigma22))
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
#d
sigma12 <- (1/13)*matrix(cbind(c(1,2,1),c(3,-2,3)), nrow=2, byrow=TRUE)
sigma22 <- (1/13)*matrix(cbind(c(5,4,2),c(4,10,1),c(2,1,9)), nrow=3, byrow=TRUE)
fractions(sigma12%*%solve(sigma22))
sigma12
fractions(sigma12)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
solve(sigma22)
fractions(solve(sigma22))
u2 <- matrix(c(x3+1,x4-2,x5+2), nrow=5, byrow=TRUE)
sigma12-fractions(sigma12%*%(solve(sigma22))%*%sigma21)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
#e
rho_12 <- -2/(sqrt(56))
source("D:/School/ADMU/3Y/Sem 2/MATH 62.2/PS1.R", echo=TRUE)
rho_12
fractions(rho_12)
A <- matrix(cbind(c(1,0,1),c(2,3,4),c(0,-3,-2)),nrow=3)
A
A <- matrix(cbind(c(1,0,1),c(2,3,4),c(0,-3,-2)),nrow=3,byrow=TRUE)
A
AGinv <- matrix(cbind(c(1,0,-1/2),c(0,0,0),c(0,0,-1/2)),nrow=3,byrow=TRUE)
A %*% AGinv %*% A
aginv
AGinv
AGinv <- matrix(cbind(c(1,0,1/2),c(0,0,0),c(0,0,-1/2)),nrow=3,byrow=TRUE)
A %*% AGinv %*% A
rank(A)
echelon(A)
library(MASS)
library(matlib)
echelon(A)\
echelon(A)
A %*% AGinv
det(A)
rank(A)
qr(A)
u <- c(1,-1,3)
u
sigma <- matrix(cbind(c(1,1,0),c(1,2,3),c(0,3,10)),nrow=3,byrow=TRUE)
A2 <- matrix(cbind(c(1,-1,1),c(3,1,-2)),nrow=2,byrow=TRUE)
A2%*%u
A2%*%sigma%*%A2
A2%*%sigma%*%t(A2)
B2 <- matrix(cbind(c(2,-1,1),c(1,2,3),c(1,1,2)),nrow=3,byrow=TRUE)
B2%*%u
B2%*%sigma%*%t(B2)
A2%*%sigma%*%t(B2)
b2
B2
B2 <- matrix(cbind(c(2,-1,1),c(1,2,-3),c(1,1,2)),nrow=3,byrow=TRUE)
B2%*%u
B2%*%sigma%*%t(B2)
A2%*%sigma%*%t(B2)
a3 <- c(1,-1)
zu <- A2%*%u
zsigma <- A2%*%sigma%*%A2
zsigma <- A2%*%sigma%*%t(A2)
a3%*%zu
a3%*%zsigma%*%a3
xpnorm(0,9,74)
pnorm(0,9,74)
pnorm(0,9,sqrt(74))
pnorm(-9/sqrt(74),0,1)
c(-14,-49)%*%c(-14,-49)
t(c(-14,-49))%*%c(-14,-49)
source("C:/Users/Paulo Mercado/Downloads/2Regression.R", echo=TRUE)
source("C:/Users/Paulo Mercado/Downloads/2Regression.R", echo=TRUE)
summary(BostonHousing)
plot(BostonHousing)
corrplot(housing.corr ,method="color",type="upper")
housing.full
housing.full.res
source("C:/Users/Paulo Mercado/Downloads/2Regression.R", echo=TRUE)
housing.full$coefficients #regression coefficients
housing.full.res$fstatistic #F-test for linear hypothesis
housing.full.res$coefficients #generalized linear hypotheses
housing.full.res$adj.r.squared # adjR2
#load dataset
data=read.csv("rates.csv")
#load dataset
data=read.csv("rates.csv")
#load dataset
setwd("D:\School\ADMU\M AMF\SEM 2\271.7")
#load dataset
setwd("D:/School\ADMU\M AMF\SEM 2\271.7")
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[[date_col_name]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
data_filtered <- data[data[["Date"]] <= as.Date("1996-12-31"), ]
data.pc = data_filtered[-1]/100
names(data.pc)
pc1 = prcomp(data.pc, scale=T)
summary(pc1)
plot(pc1, type="l")
pc1$rotation
pc1$rotation[,1]
pc1$rotation[,2]
data.pc = data_filtered.diff(1)
data.pc = data_filtered.diff()
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
data <- diff(data)
data <- diff(data, lag=1)
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
data <- data.frame(lapply(data, diff, lag = 1))
data_filtered <- data[data[["Date"]] <= as.Date("1996-12-31"), ]
data.pc = data_filtered[-1]/100
names(data.pc)
data.pc
View(data.pc)
View(data_filtered)
data <- data.frame(
date = data$date[-1],
lapply(data[ , !names(data) %in% "date"], diff, lag = 1)
)
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
data <- data.frame(
date = data$date[-1],
lapply(data[ , !names(data) %in% "date"], diff, lag = 1)
)
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
rownames(data) <- data$date
data$date <- NULL
data <- data.frame(lapply(data, diff, lag = 1))
data_filtered <- data[data[["Date"]] <= as.Date("1996-12-31"), ]
data_filtered <- data[data$Date <= as.Date("1996-12-31"), ]
View(data_filtered)
View(data_filtered)
View(data)
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
rownames(data) <- data$date
data$date <- NULL
View(data)
dates <- data$date
dates <- data$Date
data$date <- NULL
data <- data.frame(lapply(data, diff, lag = 1))
View(data)
data$Date <- NULL
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
dates <- data$Date
data$Date <- NULL
data <- data.frame(lapply(data, diff, lag = 1))
data_filtered <- data[data$Date <= as.Date("1996-12-31"), ]
View(data)
data$Date <- as.Date(rownames(data))
data$Date <- dates
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
dates <- data$Date
data$Date <- NULL
data <- data.frame(lapply(data, diff, lag = 1))
data$Date <- dates[-1]
data_filtered <- data[data$Date <= as.Date("1996-12-31"), ]
View(data_filtered)
data.pc = data_filtered[-1]/100
names(data.pc)
View(data_filtered)
data.pc = data_filtered[,-ncol(data_filtered)]/100
View(data.pc)
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data[["Date"]] <- as.Date(data[["Date"]], format = "%m/%d/%Y")
dates <- data$Date
data$Date <- NULL
data <- data.frame(lapply(data, diff, lag = 1))
data$Date <- dates[-1]
data_filtered <- data[data$Date <= as.Date("1996-12-31"), ]
data.pc = data_filtered[,-ncol(data_filtered)]/100
names(data.pc)
View(data_filtered)
View(data.pc)
#perform PCA on scaled data
pc1 = prcomp(data.pc, scale=T)
summary(pc1)
plot(pc1, type="l")
pc1$rotation
pc1$rotation[,1]
pc1$rotation[,2]
pc1$rotation[,3]
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
#load dataset
setwd("D:/School/ADMU/M AMF/SEM 2/271.7")
data=read.csv("rates.csv")
data$Date <- as.Date(data$Date, format = "%m/%d/%Y")
dates <- data$Date
# Diff all numeric columns
data_diff <- data.frame(lapply(data[ , sapply(data, is.numeric)], diff))
data_diff$Date <- dates[-1]
# Filter
data_filtered <- subset(data_diff, Date <= as.Date("1996-12-31"))
# Percent change (exclude Date)
data.pc <- data_filtered[ , -ncol(data_filtered)] / 100
names(data.pc)
#perform PCA on scaled data
pc1 = prcomp(data.pc, scale=T)
summary(pc1)
plot(pc1, type="l")
pc1$rotation
weights <- c(0, 0, 0, 100, 100, 0, -100, 0, 0, 0)
f1 <- sum(weights * loadings[ , "PC1"])
f1 <- sum(weights * pca$rotation[ , "PC1"])
f1 <- sum(weights * pc1$rotation[ , "PC1"])
f2 <- sum(weights * pc1$rotation[ , "PC2"])
f3 <- sum(weights * pc1$rotation[ , "PC3"])
f1
f2
f3
CF <- matrix(c(
5, 105, 0,   0,   0,   # 2Y
5, 5, 105,   0,   0,   # 3Y
-5,-5, -5,  -5, -105    # 5Y
), nrow=3, byrow=TRUE)
rownames(CF) <- c("2y","3y","5y")
colnames(CF) <- paste0("Y", 1:5)
View(CF)
CF <- matrix(c(
5, 105, 0,   0,   0,   # 2Y
5, 5, 105,   0,   0,   # 3Y
-5,-5, -5,  -5, -105    # 5Y
), nrow=3, byrow=TRUE)
View(CF)
# Portfolio weights = sum across bonds
total_CF <- colSums(CF)
# PV factor: zero-coupon yield curve flat at 5%
y <- 0.05
years <- 1:5
DF <- 1 / (1+y)^years
DF
source("D:/School/ADMU/M AMF/SEM 2/271.7/pca.R", echo = TRUE)
DF <- exp(-y*years)
DF
# Present value of each cash flow: Bi = CF * DF
Bi <- CF %*% DF  # matrix multiplication
Bi
View(CF)
# Present value of each cash flow: Bi = CF * DF
Bi <- total_CF %*% DF  # matrix multiplication
View(Bi)
total_CF
total_CF*DF
# Present value of each cash flow: Bi = CF * DF
Bi <- total_CF * DF  # matrix multiplication
Bi  # PV per bond
# Total portfolio PV per year (BiTi)
BiTi <- Bi * years  # multiply each PV by year for duration-like measure
BiTi
# Total portfolio PV per year (BiTi)
BiTi <- -Bi * years/10000  # in bps
BiTi
View(data)
pc1$rotation
weights = c(0,0,1,1,1,1,1,0,0,0)
a1 <- sum(weights * pc1$rotation[ , "PC1"])
a1
a1 <- weights * pc1$rotation[ , "PC1"]
a1
BiTi
f1 <- sum(a1*BiTi)
f1
f1 <- sum(a1*BiTi)
f2 <- sum(a2*BiTi)
f3 <- sum(a3*BiTi)
a2 <- weights * pc1$rotation[ , "PC2"]
a3 <- weights * pc1$rotation[ , "PC3"]
f1 <- sum(a1*BiTi)
f2 <- sum(a2*BiTi)
f3 <- sum(a3*BiTi)
pc1$rotation
f1
a1
a1 <- (weights * pc1$rotation[ , "PC1"])[weights != 0]
a2 <- (weights * pc1$rotation[ , "PC2"])[weights != 0]
a3 <- (weights * pc1$rotation[ , "PC3"])[weights != 0]
f1 <- sum(a1*BiTi)
f2 <- sum(a2*BiTi)
f3 <- sum(a3*BiTi)
f1
f2
f3
summarypc1
summary(pc1)
pc1$sdev[1]
VaR1 <- qnorm(0.95)*(f1^2)*pc1$sdev[1]^2
vaR1
VaR1
VaR2 <- qnorm(0.95)*((f1^2)*pc1$sdev[1]^2+(f2^2)*pc1$sdev[2]^2)
VaR3 <- qnorm(0.95)*((f1^2)*pc1$sdev[1]^2+(f2^2)*pc1$sdev[2]^2+(f3^2)*pc1$sdev[3]^2)
VaR2
VaR3
View(pc1)
pc1$rotation[,1]
pc1$rotation[,2]
pc1$rotation[,3]
f1
f2
f3
VaR1
VaR2
VaR3
View(data_diff)
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))
backtestdata
View(backtestdata)
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))[ , -ncol(data_diff)]
View(backtestdata)
weights*backtestdata
check <- weights*backtestdata
View(check)
check <- weights%*%backtestdata
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))[ 2, 8]
backtestdata
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))[2, 8]
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))[, 2:8]
View(backtestdata)
#backtest
backtestdata <- subset(data_diff, Date > as.Date("1996-12-31"))[, 3:7]
View(backtestdata)
dailyPL <- as.matrix(backtestdata) %*% BiTi
dailyPL
View(dailyPL)
backtestdates <- subset(dates, Date > as.Date("1996-12-31"))
backtestdates <- subset(dates > as.Date("1996-12-31"))
backtestdates <- dates[dates > as.Date("1996-12-31")]
dailyPL <- as.matrix(backtestdata) %*% BiTi
backtest_results <- data.frame(
Date = backtestdates,  # your corresponding dates
pf_PL = pf_PL,
exceed_1F = pf_PL < -VaR_1F,
exceed_2F = pf_PL < -VaR_2F,
exceed_3F = pf_PL < -VaR_3F
)
backtest_results <- data.frame(
Date = backtestdates,  # your corresponding dates
dailyPL = dailyPL,
exceed_1F = dailyPL < -VaR_1F,
exceed_2F = dailyPL < -VaR_2F,
exceed_3F = dailyPL < -VaR_3F
)
backtest_results <- data.frame(
Date = backtestdates,  # your corresponding dates
dailyPL = dailyPL,
exceed_1 = dailyPL < -VaR1,
exceed_2 = dailyPL < -VaR2,
exceed_3 = dailyPL < -VaR3
)
View(backtest_results)
colSums(backtest_results[ , 3:5])
colSums(backtest_results[ , 3:5])/len(backtestdates)
colSums(backtest_results[ , 3:5])/length(backtestdates)
